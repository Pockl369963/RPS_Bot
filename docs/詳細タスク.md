# 詳細タスクリスト：Evolutionary RPS 実装ガイド

このドキュメントは、`詳細設計.md` に基づき、最強のじゃんけんBotをステップ・バイ・ステップで実装するためのガイドです。
各タスクは「設計の意図」を理解しながら進められるように構成されています。
また、**Git/GitHubを用いた実践的なワークフロー**（ブランチ運用）も併せて学習します。

---

## Phase 0: Gitの準備 (Git Setup)
プロジェクトを始める前に、バージョン管理の準備をします。

- [ ] **0.1 リポジトリの初期化**
    - [ ] GitHubで新しいリポジトリ `evolutionary-rps` を作成する（README等は無しでOK）
    - [ ] ローカルで `git init` を実行
    - [ ] `.gitignore` を作成（Python, Django, venv, .DS_Store等を除外）
    - [ ] `git add .` -> `git commit -m "Initial commit"`
    - [ ] `git branch -M main`
    - [ ] `git remote add origin <YOUR_REPO_URL>`
    - [ ] `git push -u origin main`

---

## Phase 1: プロジェクトの土台を作る (Environment & Setup)
まずは開発環境を整え、Djangoプロジェクトの骨格を作ります。

- [ ] **Git: ブランチ作成**
    - [ ] `git checkout -b feature/setup`
- [ ] **1.1 環境構築**
    - [ ] `uv` を使って仮想環境を作成する
    - [ ] 必要なパッケージ (`django`, `pytest`, `pytest-django`) をインストールする
    - [ ] `requirements.txt` を出力する
- [ ] **1.2 Djangoプロジェクト作成**
    - [ ] `django-admin startproject rps_project .` でプロジェクトを作成
    - [ ] `python manage.py startapp game` でゲーム用アプリを作成
    - [ ] `settings.py` に `game` アプリを登録する
    - [ ] サーバーが起動することを確認 (`python manage.py runserver`)
- [ ] **Git: マージ & プッシュ**
    - [ ] `git add .` -> `git commit -m "Setup Django project structure"`
    - [ ] `git checkout main`
    - [ ] `git merge feature/setup`
    - [ ] `git push origin main`

---

## Phase 2: データの形を定義する (Models & Database)
「誰が」「どんな対戦をしたか」を保存するためのデータベース設計を実装します。**TDD（テスト駆動開発）**で進めます。

- [ ] **Git: ブランチ作成**
    - [ ] `git checkout -b feature/models`
- [ ] **2.1 Playerモデルの実装 (TDD)**
    - [ ] `tests/test_models.py` を作成し、`Player` モデルが作成できるか確認するテストを書く (Red)
    - [ ] `models.py` に `Player` モデル (UUID, 勝敗数など) を定義する (Green)
    - [ ] マイグレーションファイルを作成し、DBに適用する
- [ ] **2.2 GameLogモデルの実装 (TDD)**
    - [ ] `GameLog` が `Player` と紐付いて保存されるか確認するテストを書く (Red)
    - [ ] `models.py` に `GameLog` モデル (手、結果、戦略など) を定義する (Green)
    - [ ] マイグレーションを実行する
- [ ] **Git: マージ & プッシュ**
    - [ ] `git add .` -> `git commit -m "Implement Player and GameLog models"`
    - [ ] `git checkout main`
    - [ ] `git merge feature/models`
    - [ ] `git push origin main`

---

## Phase 3: AIの頭脳を作る (Core Logic & AI Engine)
このプロジェクトの核心部分です。単純な確率計算から、高度な心理戦ロジックまでを実装します。

- [ ] **Git: ブランチ作成**
    - [ ] `git checkout -b feature/ai-engine`
- [ ] **3.1 予測器の基盤作成**
    - [ ] `game/ai/predictors.py` を作成
    - [ ] 全ての予測器が継承すべき基底クラス (インターフェース) を定義する
- [ ] **3.2 基本的な予測器の実装 (TDD)**
    - [ ] **Random予測器**: テスト作成 -> 実装
    - [ ] **Markov Chain (1次)**: 「グーの次はパーが出やすい」等を学習できるかテスト -> 実装
    - [ ] **Frequency Analysis**: 「一番多い手」に勝てるかテスト -> 実装
- [ ] **3.3 高度な予測器の実装 (TDD)**
    - [ ] **Pattern Matcher**: 過去のパターンを認識できるかテスト -> 実装
- [ ] **3.4 メタ戦略 (Selector) の実装**
    - [ ] `game/ai/strategy.py` を作成
    - [ ] 各予測器の「仮想勝率」を計算し、ベストな手を選べるかテスト -> 実装
- [ ] **3.5 安全策 (Safety Mechanisms) の実装**
    - [ ] **Anti-Spam**: 「グー連打」を検知して必勝手を出せるかテスト -> 実装
    - [ ] **Stop-Loss**: 負けが込んだらランダムに切り替わるかテスト -> 実装
- [ ] **Git: マージ & プッシュ**
    - [ ] `git add .` -> `git commit -m "Implement AI predictors and strategy logic"`
    - [ ] `git checkout main`
    - [ ] `git merge feature/ai-engine`
    - [ ] `git push origin main`

---

## Phase 4: サーバーと会話する (API Development)
フロントエンド（ブラウザ）からの要求を受け取り、AIを使って結果を返す窓口を作ります。

- [ ] **Git: ブランチ作成**
    - [ ] `git checkout -b feature/api`
- [ ] **4.1 Play APIの実装 (TDD)**
    - [ ] `POST /api/play/` にリクエストを送ると、JSONが返ってくるかテスト (Red)
    - [ ] `views.py` にAPIビューを実装 (Green)
        - ユーザーIDの取得/生成
        - AIによる手の決定
        - 勝敗判定とログ保存
        - レスポンス返却
- [ ] **4.2 Reset APIの実装**
    - [ ] 履歴リセット機能の実装
- [ ] **Git: マージ & プッシュ**
    - [ ] `git add .` -> `git commit -m "Implement Play and Reset APIs"`
    - [ ] `git checkout main`
    - [ ] `git merge feature/api`
    - [ ] `git push origin main`

---

## Phase 5: 画面を作る (Frontend Development)
ユーザーが実際に触れるインターフェースを作ります。AIの「強さ」を演出で表現します。

- [ ] **Git: ブランチ作成**
    - [ ] `git checkout -b feature/frontend`
- [ ] **5.1 基本画面の構築**
    - [ ] `index.html` を作成し、Tailwind CSSをCDNで読み込む
    - [ ] グー・チョキ・パーのボタンと、結果表示エリアを配置する
- [ ] **5.2 ゲームロジックの接続 (JavaScript)**
    - [ ] `game.js` を作成
    - [ ] ボタンクリック時にAPIを叩き、結果を画面に表示する処理を実装
- [ ] **5.3 ダイナミック・テーマの実装**
    - [ ] フェーズ（対戦数・勝率）に応じて背景色が変わる演出を追加
    - [ ] AIが「本気」を出した時のGlitchエフェクトなどを追加
- [ ] **Git: マージ & プッシュ**
    - [ ] `git add .` -> `git commit -m "Implement frontend UI and game logic"`
    - [ ] `git checkout main`
    - [ ] `git merge feature/frontend`
    - [ ] `git push origin main`

---

## Phase 6: 仕上げと公開 (Polish & Deploy)
- [ ] **Git: ブランチ作成**
    - [ ] `git checkout -b release/v1.0`
- [ ] **6.1 全体テスト**
    - [ ] 全てのテストが通ることを確認
    - [ ] 実際に遊んでみて、違和感がないか調整
- [ ] **6.2 デプロイ**
    - [ ] PythonAnywhere等の環境にデプロイし、世界中に公開する
- [ ] **Git: マージ & プッシュ**
    - [ ] `git add .` -> `git commit -m "Final polish for release"`
    - [ ] `git checkout main`
    - [ ] `git merge release/v1.0`
    - [ ] `git tag v1.0`
    - [ ] `git push origin main --tags`
